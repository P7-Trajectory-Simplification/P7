<!doctype html>
<html lang='en'>
  <head>
    <meta charset='utf-8'>
    <link rel='stylesheet'
      href="{{url_for('static', filename='CSS/style.css')}}">
    <link rel='stylesheet'
      href='https://unpkg.com/leaflet@1.9.4/dist/leaflet.css'
      integrity='sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY='
      crossorigin />
    <link rel='preconnect' href='https://fonts.googleapis.com'>
    <link rel='preconnect' href='https://fonts.gstatic.com' crossorigin>
    <link
      href='https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap'
      rel='stylesheet'>
  </head>
  <body>
    <div class='body'>
      <div class='title'>
        <h1>Trajectory Simplification Map</h1>
      </div>
      <div id="buttons">
        <div class='algorithms'>
          {% for alg in algorithms %}
          <div class='checkbox'>
            <input type='checkbox' id='{{alg}}' value='{{alg}}'>
            <label for='{{alg}}'>{{alg}}</label><br>
          </div>
          {% endfor %}
        </div>
        <div id="analytics">
          <button id="show_errors">
            Analytics
            <svg class="inactive" xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 640 640"><path
                d="M441.3 299.8C451.5 312.4 450.8 330.9 439.1 342.6L311.1 470.6C301.9 479.8 288.2 482.5 276.2 477.5C264.2 472.5 256.5 460.9 256.5 448L256.5 192C256.5 179.1 264.3 167.4 276.3 162.4C288.3 157.4 302 160.2 311.2 169.3L439.2 297.3L441.4 299.7z" /></svg>
            <svg class="active" xmlns="http://www.w3.org/2000/svg"
              viewBox="0 0 640 640"><path
                d="M300.3 440.8C312.9 451 331.4 450.3 343.1 438.6L471.1 310.6C480.3 301.4 483 287.7 478 275.7C473 263.7 461.4 256 448.5 256L192.5 256C179.6 256 167.9 263.8 162.9 275.8C157.9 287.8 160.7 301.5 169.9 310.6L297.9 438.6L300.3 440.8z" /></svg>
          </button>
        </div>
      </div>
      <div id="alg_settings">
        {% set alg_params = {
        'DR': [
        {'label': 'Tolerance', 'name': 'tolerance', 'type': 'number', 'default':
        2000, 'step': 1, 'min': 0, 'desc': 'Max allowed distance from predicted point to received point in meters. Minimum value = 0.'}
        ],
        'DP': [
        {'label': 'Epsilon', 'name': 'epsilon', 'type': 'number', 'default':
        6000, 'step': 1, 'min': 0, 'desc': 'The maximum distance threshold for simplification. Minimum value = 0.'}
        ],
        'SQUISH': [
        {'label': 'Buffer Size', 'name': 'buff_size', 'type': 'number',
        'default': 6300, 'step': 1, 'min': 2, 'desc': 'The buffer size for the squish algorithm. Denotes the maximum amount of trajectory points allowed in the result. Minimum value = 2.'}
        ],
        'SQUISH_E': [
        {'label': 'Upper Bound SED', 'name': 'max_sed', 'type': 'number',
        'default': 0, 'step': 1, 'min': 0, 'desc': 'The upper bound SED error, if = 0, SQUISH-E only cares about compression rate. All points with an SED lower than this value will be removed from the simplification. Minimum value = 0.'}
        ],
        'SQUISH_E_2': [
        {'label': 'Lowest Compression', 'name': 'low_comp', 'type': 'number',
        'default': 10, 'step': 1, 'min': 1, 'desc': 'The lower bound compression rate. If = 1, SQUISH-E only simplifies based on SED error. Minimum value = 1 and all points can be kept in the buffer. If = 2, compresses the data to around +- 50%.'}
        ],
        'UNIFORM_SAMPLING': [
        {'label': 'Sampling Rate', 'name': 'sampling_rate', 'type': 'number',
        'default': 10, 'step': 1, 'min': 1, 'desc': 'The rate at which to sample points from the trajectory. A sampling rate of 10 means that every 10th point will be kept. Minimum value = 1.'}
        ]
        } %}
        {% for alg, params in alg_params.items() %}
        <div class="alg_params">
          {% for param in params %}
          <div class="alg_desc_box">
            <label for="{{param.name}}">{{ param.label }}:</label>
            <button class="help_button" id="{{param.name}}_help" onclick="show_help('{{param.desc}}')">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                aria-hidden="true" viewBox="0 0 24 24" focusable="false"><path
                  d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm-1-4h2v2h-2zm1.61-9.96c-2.06-.3-3.88.97-4.43 2.79-.18.58.26 1.17.87 1.17h.2c.41 0 .74-.29.88-.67.32-.89 1.27-1.5 2.3-1.28.95.2 1.65 1.13 1.57 2.1-.1 1.34-1.62 1.63-2.45 2.88 0 .01-.01.01-.01.02-.01.02-.02.03-.03.05-.09.15-.18.32-.25.5-.01.03-.03.05-.04.08-.01.02-.01.04-.02.07-.12.34-.2.75-.2 1.25h2c0-.42.11-.77.28-1.07.02-.03.03-.06.05-.09.08-.14.18-.27.28-.39.01-.01.02-.03.03-.04.1-.12.21-.23.33-.34.96-.91 2.26-1.65 1.99-3.56-.24-1.74-1.61-3.21-3.35-3.47z"></path></svg>
            </button>
          </div>
          <input
            id="{{param.name}}"
            name="{{param.name}}"
            type="{{ param.type }}"
            value="{{ param.default }}"
            {% if param.min is defined %}min="{{ param.min }}" {% endif %}
            {% if param.max is defined %}max="{{ param.max }}" {% endif %}
            {% if param.step is defined %}step="{{ param.step }}" {% endif %}
            disabled>
          {% endfor %}
        </div>
        {% endfor %}
      </div>
      <div id="analytics_info">
        <table>
        </table>
      </div>
      <div id="colors">
          {% set alg_colors = {
          'RAW': 'blue',
          'DP': 'red',
            'DR': 'yellow',
            'SQUISH': 'green',
            'SQUISH_E': 'cyan',
            'UNIFORM_SAMPLING': 'orange',
            'SQUISH_RECKONING': 'magenta'
        } %}
        {% for alg, color in alg_colors.items() %}
        <div class="color_box">
          <div class="color_sample {{ color }}"></div>
          <label>{{ alg }}</label>
        </div>
        {% endfor %}




      </div>
      <div id='map'></div>
      <div id='settings'>
        <div id='output_box'>
          <output id='time_value'></output>
        </div>
        <div id='date_box'>
          <div class='date_subbox'>
            <label for='start_date'>Start Date:</label>
            <input type='date' id='start_date' value='2024-01-01'
              min='2024-01-01'
              max='2024-01-31'>
          </div>
          <div class='date_subbox'>
            <label for='end_date'>Current Date:</label>
            <input type='date' id='end_date' value='2024-01-17' min='2024-01-01'
              max='2024-01-31'>
          </div>
        </div>
      </div>
      <div id='range_container'>
        <button id='play_button' class='play'>
          <svg class='pause' xmlns='http://www.w3.org/2000/svg' id='Filled'
            viewBox='0 0 24 24' width='512' height='512'><path
              d='M6.5,0A3.5,3.5,0,0,0,3,3.5v17a3.5,3.5,0,0,0,7,0V3.5A3.5,3.5,0,0,0,6.5,0Z' /><path
              d='M17.5,0A3.5,3.5,0,0,0,14,3.5v17a3.5,3.5,0,0,0,7,0V3.5A3.5,3.5,0,0,0,17.5,0Z' /></svg>
          <svg class='play' xmlns='http://www.w3.org/2000/svg' id='Filled'
            viewBox='0 0 24 24' width='512' height='512'><path
              d='M20.492,7.969,10.954.975A5,5,0,0,0,3,5.005V19a4.994,4.994,0,0,0,7.954,4.03l9.538-6.994a5,5,0,0,0,0-8.062Z' /></svg>
        </button>
        <input type='range' id='time_range' class='slider' min='0' max='86399'
          value='0' step='3600' oninput='updateSlider(this)'>
      </div>
    </body>
    <script src='https://unpkg.com/leaflet@1.9.4/dist/leaflet.js'
      integrity='sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo='
      crossorigin></script>
    <script
      src="{{url_for('static', filename='JS/leaflet.polylineDecorator.js')}}"></script>
    <script src="{{url_for('static', filename='JS/api.js')}}"></script>
    <script src="{{url_for('static', filename='JS/map.js')}}"></script>
    <script src="{{url_for('static', filename='JS/index.js')}}"></script>
    <script src="{{url_for('static', filename='JS/analytics.js')}}"></script>
